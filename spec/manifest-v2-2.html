
<!DOCTYPE HTML>
<html lang="us-en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Image Manifest V 2 Schema 2 · distribution 英文文档</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="image manifest for the Registry.">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism-solarizedlight.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="menu.html" />
    
    
    <link rel="prev" href="manifest-v2-1.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://docs.khs1994.com" target="_blank" class="custom-link">Home</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" >
            
                <span>
            
                    
                    Recipes
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="../recipes/apache.html">
            
                <a href="../recipes/apache.html">
            
                    
                    Authenticate Proxy With Apache
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="../recipes/">
            
                <a href="../recipes/">
            
                    
                    Recipes Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.3" data-path="../recipes/mirror.html">
            
                <a href="../recipes/mirror.html">
            
                    
                    Registry As A Pull Through Cache
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.4" data-path="../recipes/nginx.html">
            
                <a href="../recipes/nginx.html">
            
                    
                    Authenticate Proxy With Nginx
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.5" data-path="../recipes/osx-setup-guide.html">
            
                <a href="../recipes/osx-setup-guide.html">
            
                    
                    Mac OS Setup Guide
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Spec
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" >
            
                <span>
            
                    
                    Auth
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="auth/">
            
                <a href="auth/">
            
                    
                    Docker Registry Token Authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="auth/jwt.html">
            
                <a href="auth/jwt.html">
            
                    
                    Token Authentication Implementation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.3" data-path="auth/oauth.html">
            
                <a href="auth/oauth.html">
            
                    
                    Oauth 2 Token Authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.4" data-path="auth/scope.html">
            
                <a href="auth/scope.html">
            
                    
                    Token Scope Documentation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.5" data-path="auth/token.html">
            
                <a href="auth/token.html">
            
                    
                    Token Authentication Specification
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="api.html">
            
                <a href="api.html">
            
                    
                    HTTP API V 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="deprecated-schema-v1.html">
            
                <a href="deprecated-schema-v1.html">
            
                    
                    Update Deprecated Schema Image Manifest Version 2 V 1 Images
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="implementations.html">
            
                <a href="implementations.html">
            
                    
                    Implementations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="./">
            
                <a href="./">
            
                    
                    Reference Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="json.html">
            
                <a href="json.html">
            
                    
                    Docker Distribution JSON Canonicalization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="manifest-v2-1.html">
            
                <a href="manifest-v2-1.html">
            
                    
                    Image Manifest V 2 Schema 1
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.8" data-path="manifest-v2-2.html">
            
                <a href="manifest-v2-2.html">
            
                    
                    Image Manifest V 2 Schema 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="menu.html">
            
                <a href="menu.html">
            
                    
                    Reference
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Storage Drivers
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../storage-drivers/azure.html">
            
                <a href="../storage-drivers/azure.html">
            
                    
                    Microsoft Azure Storage Driver
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../storage-drivers/filesystem.html">
            
                <a href="../storage-drivers/filesystem.html">
            
                    
                    Filesystem Storage Driver
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../storage-drivers/gcs.html">
            
                <a href="../storage-drivers/gcs.html">
            
                    
                    Google Cloud Storage Driver
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../storage-drivers/">
            
                <a href="../storage-drivers/">
            
                    
                    Registry Storage Driver
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../storage-drivers/inmemory.html">
            
                <a href="../storage-drivers/inmemory.html">
            
                    
                    In Memory Storage Driver Testing Only
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../storage-drivers/oss.html">
            
                <a href="../storage-drivers/oss.html">
            
                    
                    Aliyun OSS Storage Driver
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../storage-drivers/s3.html">
            
                <a href="../storage-drivers/s3.html">
            
                    
                    S 3 Storage Driver
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../storage-drivers/swift.html">
            
                <a href="../storage-drivers/swift.html">
            
                    
                    Open Stack Swift Storage Driver
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../architecture.html">
            
                <a href="../architecture.html">
            
                    
                    Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../compatibility.html">
            
                <a href="../compatibility.html">
            
                    
                    Registry Compatibility
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../configuration.html">
            
                <a href="../configuration.html">
            
                    
                    Configuring A Registry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../deploying.html">
            
                <a href="../deploying.html">
            
                    
                    Deploy A Registry Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../deprecated.html">
            
                <a href="../deprecated.html">
            
                    
                    Docker Registry Deprecation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../garbage-collection.html">
            
                <a href="../garbage-collection.html">
            
                    
                    Garbage Collection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../glossary.html">
            
                <a href="../glossary.html">
            
                    
                    Glossary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../help.html">
            
                <a href="../help.html">
            
                    
                    Get Help
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../insecure.html">
            
                <a href="../insecure.html">
            
                    
                    Test An Insecure Registry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../introduction.html">
            
                <a href="../introduction.html">
            
                    
                    About Registry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../migration.html">
            
                <a href="../migration.html">
            
                    
                    Migration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../notifications.html">
            
                <a href="../notifications.html">
            
                    
                    Work With Notifications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../">
            
                <a href="../">
            
                    
                    Docker Registry
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Image Manifest V 2 Schema 2</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="image-manifest-version-2-schema-2">Image Manifest Version 2, Schema 2</h1>
<p>This document outlines the format of the V2 image manifest, schema version 2.
The original (and provisional) image manifest for V2 (schema 1), was introduced
in the Docker daemon in the <a href="https://github.com/docker/docker/commit/9f482a66ab37ec396ac61ed0c00d59122ac07453" target="_blank">v1.3.0
release</a>
and is specified in the <a href="manifest-v2-1.html">schema 1 manifest definition</a></p>
<p>This second schema version has two primary goals. The first is to allow
multi-architecture images, through a &quot;fat manifest&quot; which references image
manifests for platform-specific versions of an image. The second is to
move the Docker engine towards content-addressable images, by supporting
an image model where the image&apos;s configuration can be hashed to generate
an ID for the image.</p>
<h1 id="media-types">Media Types</h1>
<p>The following media types are used by the manifest formats described here, and
the resources they reference:</p>
<ul>
<li><code>application/vnd.docker.distribution.manifest.v1+json</code>: schema1 (existing manifest format)</li>
<li><code>application/vnd.docker.distribution.manifest.v2+json</code>: New image manifest format (schemaVersion = 2)</li>
<li><code>application/vnd.docker.distribution.manifest.list.v2+json</code>: Manifest list, aka &quot;fat manifest&quot;</li>
<li><code>application/vnd.docker.container.image.v1+json</code>: Container config JSON</li>
<li><code>application/vnd.docker.image.rootfs.diff.tar.gzip</code>: &quot;Layer&quot;, as a gzipped tar</li>
<li><code>application/vnd.docker.image.rootfs.foreign.diff.tar.gzip</code>: &quot;Layer&quot;, as a gzipped tar that should never be pushed</li>
<li><code>application/vnd.docker.plugin.v1+json</code>: Plugin config JSON</li>
</ul>
<h2 id="manifest-list">Manifest List</h2>
<p>The manifest list is the &quot;fat manifest&quot; which points to specific image manifests
for one or more platforms. Its use is optional, and relatively few images will
use one of these manifests. A client will distinguish a manifest list from an
image manifest based on the Content-Type returned in the HTTP response.</p>
<h2 id="manifest-list-field-descriptions"><em>Manifest List</em> Field Descriptions</h2>
<ul>
<li><p><strong><code>schemaVersion</code></strong> <em>int</em></p>
<p>This field specifies the image manifest schema version as an integer. This
schema uses the version <code>2</code>.</p>
</li>
<li><p><strong><code>mediaType</code></strong> <em>string</em></p>
<p>  The MIME type of the manifest list. This should be set to
  <code>application/vnd.docker.distribution.manifest.list.v2+json</code>.</p>
</li>
<li><p><strong><code>manifests</code></strong> <em>array</em></p>
<p>  The manifests field contains a list of manifests for specific platforms.</p>
<p>  Fields of an object in the manifests list are:</p>
<ul>
<li><p><strong><code>mediaType</code></strong> <em>string</em></p>
<p>  The MIME type of the referenced object. This will generally be
  <code>application/vnd.docker.distribution.manifest.v2+json</code>, but it could also
  be <code>application/vnd.docker.distribution.manifest.v1+json</code> if the manifest
  list references a legacy schema-1 manifest.</p>
</li>
<li><p><strong><code>size</code></strong> <em>int</em></p>
<p>  The size in bytes of the object. This field exists so that a client
  will have an expected size for the content before validating. If the
  length of the retrieved content does not match the specified length,
  the content should not be trusted.</p>
</li>
<li><p><strong><code>digest</code></strong> <em>string</em></p>
<p>  The digest of the content, as defined by the
  <a href="api.html#digest-parameter">Registry V2 HTTP API Specificiation</a>.</p>
</li>
<li><p><strong><code>platform</code></strong> <em>object</em></p>
<p>  The platform object describes the platform which the image in the
  manifest runs on. A full list of valid operating system and architecture
  values are listed in the <a href="https://golang.org/doc/install/source#environment" target="_blank">Go language documentation for <code>$GOOS</code> and
  <code>$GOARCH</code></a></p>
<ul>
<li><p><strong><code>architecture</code></strong> <em>string</em></p>
<p>  The architecture field specifies the CPU architecture, for example
  <code>amd64</code> or <code>ppc64le</code>.</p>
</li>
<li><p><strong><code>os</code></strong> <em>string</em></p>
<p>  The os field specifies the operating system, for example
  <code>linux</code> or <code>windows</code>.</p>
</li>
<li><p><strong><code>os.version</code></strong> <em>string</em></p>
<p>  The optional os.version field specifies the operating system version,
  for example <code>10.0.10586</code>.</p>
</li>
<li><p><strong><code>os.features</code></strong> <em>array</em></p>
<p>  The optional os.features field specifies an array of strings,
  each listing a required OS feature (for example on Windows
  <code>win32k</code>).</p>
</li>
<li><p><strong><code>variant</code></strong> <em>string</em></p>
<p>  The optional variant field specifies a variant of the CPU, for
  example <code>v6</code> to specify a particular CPU variant of the ARM CPU.</p>
</li>
<li><p><strong><code>features</code></strong> <em>array</em></p>
<p>  The optional features field specifies an array of strings, each
  listing a required CPU feature (for example <code>sse4</code> or <code>aes</code>).</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="example-manifest-list">Example Manifest List</h2>
<p><em>Example showing a simple manifest list pointing to image manifests for two platforms:</em></p>
<pre class="language-"><code class="lang-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;schemaVersion&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">&quot;mediaType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/vnd.docker.distribution.manifest.list.v2+json&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;manifests&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;mediaType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/vnd.docker.distribution.manifest.v2+json&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;digest&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sha256:e692418e4cbaf90ca69d05a66403747baa33ee08806650b51fab815ad7fc331f&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">7143</span><span class="token punctuation">,</span>
      <span class="token property">&quot;platform&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;architecture&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ppc64le&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;os&quot;</span><span class="token operator">:</span> <span class="token string">&quot;linux&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;mediaType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/vnd.docker.distribution.manifest.v2+json&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;digest&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sha256:5b0bcabd1ed22e9fb1310cf6c2dec7cdef19f0ad69efa1f392e94a4333501270&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">7682</span><span class="token punctuation">,</span>
      <span class="token property">&quot;platform&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;architecture&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amd64&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;os&quot;</span><span class="token operator">:</span> <span class="token string">&quot;linux&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;features&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;sse4&quot;</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<h1 id="image-manifest">Image Manifest</h1>
<p>The image manifest provides a configuration and a set of layers for a container
image. It&apos;s the direct replacement for the schema-1 manifest.</p>
<h2 id="image-manifest-field-descriptions"><em>Image Manifest</em> Field Descriptions</h2>
<ul>
<li><p><strong><code>schemaVersion</code></strong> <em>int</em></p>
<p>This field specifies the image manifest schema version as an integer. This
schema uses version <code>2</code>.</p>
</li>
<li><p><strong><code>mediaType</code></strong> <em>string</em></p>
<p>  The MIME type of the manifest. This should be set to
  <code>application/vnd.docker.distribution.manifest.v2+json</code>.</p>
</li>
<li><p><strong><code>config</code></strong> <em>object</em></p>
<p>  The config field references a configuration object for a container, by
  digest. This configuration item is a JSON blob that the runtime uses
  to set up the container. This new schema uses a tweaked version
  of this configuration to allow image content-addressability on the
  daemon side.</p>
<p>  Fields of a config object are:</p>
<ul>
<li><p><strong><code>mediaType</code></strong> <em>string</em></p>
<p>  The MIME type of the referenced object. This should generally be
  <code>application/vnd.docker.container.image.v1+json</code>.</p>
</li>
<li><p><strong><code>size</code></strong> <em>int</em></p>
<p>  The size in bytes of the object. This field exists so that a client
  will have an expected size for the content before validating. If the
  length of the retrieved content does not match the specified length,
  the content should not be trusted.</p>
</li>
<li><p><strong><code>digest</code></strong> <em>string</em></p>
<p>  The digest of the content, as defined by the
  <a href="api.html#digest-parameter">Registry V2 HTTP API Specificiation</a>.</p>
</li>
</ul>
</li>
<li><p><strong><code>layers</code></strong> <em>array</em></p>
<p>  The layer list is ordered starting from the base image (opposite order of schema1).</p>
<p>  Fields of an item in the layers list are:</p>
<ul>
<li><p><strong><code>mediaType</code></strong> <em>string</em></p>
<p>  The MIME type of the referenced object. This should
  generally be <code>application/vnd.docker.image.rootfs.diff.tar.gzip</code>.
  Layers of type
  <code>application/vnd.docker.image.rootfs.foreign.diff.tar.gzip</code> may be
  pulled from a remote location but they should never be pushed.</p>
</li>
<li><p><strong><code>size</code></strong> <em>int</em></p>
<p>  The size in bytes of the object. This field exists so that a client
  will have an expected size for the content before validating. If the
  length of the retrieved content does not match the specified length,
  the content should not be trusted.</p>
</li>
<li><p><strong><code>digest</code></strong> <em>string</em></p>
<p>  The digest of the content, as defined by the
  <a href="api.html#digest-parameter">Registry V2 HTTP API Specificiation</a>.</p>
</li>
<li><p><strong><code>urls</code></strong> <em>array</em></p>
<p>  Provides a list of URLs from which the content may be fetched. Content
  must be verified against the <code>digest</code> and <code>size</code>. This field is
  optional and uncommon.</p>
</li>
</ul>
</li>
</ul>
<h2 id="example-image-manifest">Example Image Manifest</h2>
<p><em>Example showing an image manifest:</em></p>
<pre class="language-"><code class="lang-json"><span class="token punctuation">{</span>
    <span class="token property">&quot;schemaVersion&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;mediaType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/vnd.docker.distribution.manifest.v2+json&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;mediaType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/vnd.docker.container.image.v1+json&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;digest&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sha256:b5b2b2c507a0944348e0303114d8d93aaaa081732b86451d9bce1f432a537bc7&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">7023</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;layers&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;mediaType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/vnd.docker.image.rootfs.diff.tar.gzip&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;digest&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sha256:e692418e4cbaf90ca69d05a66403747baa33ee08806650b51fab815ad7fc331f&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">32654</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;mediaType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/vnd.docker.image.rootfs.diff.tar.gzip&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;digest&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sha256:3c3a4604a545cdc127456d94e421cd355bca5b528f4a9c1905b15da2eb4a4c6b&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">16724</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;mediaType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/vnd.docker.image.rootfs.diff.tar.gzip&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;digest&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sha256:ec4b8955958665577945c89419d1af06b5f7636b4ac3da7f12184802ad867736&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">73109</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<h1 id="backward-compatibility">Backward compatibility</h1>
<p>The registry will continue to accept uploads of manifests in both the old and
new formats.</p>
<p>When pushing images, clients which support the new manifest format should first
construct a manifest in the new format. If uploading this manifest fails,
presumably because the registry only supports the old format, the client may
fall back to uploading a manifest in the old format.</p>
<p>When pulling images, clients indicate support for this new version of the
manifest format by sending the
<code>application/vnd.docker.distribution.manifest.v2+json</code> and
<code>application/vnd.docker.distribution.manifest.list.v2+json</code> media types in an
<code>Accept</code> header when making a request to the <code>manifests</code> endpoint. Updated
clients should check the <code>Content-Type</code> header to see whether the manifest
returned from the endpoint is in the old format, or is an image manifest or
manifest list in the new format.</p>
<p>If the manifest being requested uses the new format, and the appropriate media
type is not present in an <code>Accept</code> header, the registry will assume that the
client cannot handle the manifest as-is, and rewrite it on the fly into the old
format. If the object that would otherwise be returned is a manifest list, the
registry will look up the appropriate manifest for the amd64 platform and
linux OS, rewrite that manifest into the old format if necessary, and return
the result to the client. If no suitable manifest is found in the manifest
list, the registry will return a 404 error.</p>
<p>One of the challenges in rewriting manifests to the old format is that the old
format involves an image configuration for each layer in the manifest, but the
new format only provides one image configuration. To work around this, the
registry will create synthetic image configurations for all layers except the
top layer. These image configurations will not result in runnable images on
their own, but only serve to fill in the parent chain in a compatible way.
The IDs in these synthetic configurations will be derived from hashes of their
respective blobs. The registry will create these configurations and their IDs
using the same scheme as Docker 1.10 when it creates a legacy manifest to push
to a registry which doesn&apos;t support the new format.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="manifest-v2-1.html" class="navigation navigation-prev " aria-label="Previous page: Image Manifest V 2 Schema 1">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="menu.html" class="navigation navigation-next " aria-label="Next page: Reference">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Image Manifest V 2 Schema 2","description":"image manifest for the Registry.","keywords":"registry, on-prem, images, tags, repository, distribution, api, advanced, manifest","level":"1.2.8","depth":2,"next":{"title":"Reference","level":"1.2.9","depth":2,"path":"spec/menu.md","ref":"spec/menu.md","articles":[]},"previous":{"title":"Image Manifest V 2 Schema 1","level":"1.2.7","depth":2,"path":"spec/manifest-v2-1.md","ref":"spec/manifest-v2-1.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-sharing","-highlight","-livereload","prism"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"prism":{"css":["prismjs/themes/prism-solarizedlight.css"]},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"distribution 英文文档","language":"us-en","links":{"sidebar":{"Home":"https://docs.khs1994.com"}},"gitbook":"*"},"file":{"path":"spec/manifest-v2-2.md","mtime":"2023-01-31T01:27:31.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2023-01-31T01:28:02.961Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

